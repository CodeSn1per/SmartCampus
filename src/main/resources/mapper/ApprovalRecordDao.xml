<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.codesniper.smartcampus.dao.ApprovalRecordDao">

    <resultMap type="com.codesniper.smartcampus.entity.ApprovalRecord" id="ApprovalRecordMap">
        <result property="id" column="ID" jdbcType="VARCHAR"/>
        <result property="userId" column="USER_ID" jdbcType="VARCHAR"/>
        <result property="name" column="NAME" jdbcType="VARCHAR"/>
        <result property="approvalPerson" column="APPROVAL_PERSON" jdbcType="VARCHAR"/>
        <result property="approvalResult" column="APPROVAL_RESULT" jdbcType="VARCHAR"/>
        <result property="approvalTime" column="APPROVAL_TIME" jdbcType="TIMESTAMP"/>
        <result property="approvalReason" column="APPROVAL_REASON" jdbcType="VARCHAR"/>
        <result property="updateTime" column="UPDATE_TIME" jdbcType="TIMESTAMP"/>
        <result property="createTime" column="CREATE_TIME" jdbcType="TIMESTAMP"/>
    </resultMap>

    <select id="getApprovalRecordList" resultType="com.codesniper.smartcampus.entity.ApprovalRecord" parameterType="com.codesniper.smartcampus.dto.ApprovalRecordReq">
        SELECT ID,
        NAME,
        USER_ID,
        APPROVAL_PERSON,
        APPROVAL_RESULT,
        APPROVAL_REASON,
        APPROVAL_TIME,
        UPDATE_TIME,
        CREATE_TIME
        FROM T_APPROVAL_RECORD
        WHERE APPROVAL_PERSON=#{approvalPerson}
        <if test="name!=null and name!=''">
            AND NAME LIKE CONCAT('%',CONCAT(#{name},'%'))
        </if>
        <if test="approvalResult!=null and approvalResult!=''">
            AND APPROVAL_RESULT =#{approvalResult}
        </if>
    </select>

    <select id="queryByUserId" resultType="com.codesniper.smartcampus.entity.ApprovalRecord">
        SELECT *
        FROM T_APPROVAL_RECORD
        WHERE ID = #{id}
    </select>

    <update id="editApprovalRecord" parameterType="com.codesniper.smartcampus.entity.ApprovalRecord">
        UPDATE T_APPROVAL_RECORD
        SET NAME           =#{name},
            APPROVAL_RESULT=#{approvalResult},
            APPROVAL_REASON=#{approvalReason},
            UPDATE_TIME=#{updateTime}
        WHERE USER_ID = #{userId}
    </update>
</mapper>

